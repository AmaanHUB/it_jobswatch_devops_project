---

- name: Setting up the development environment
  hosts: deployment_env
  vars:
    app_dir: /home/ubuntu/it_jobswatch_devops_project

  # gathers state of the machine before running
  gather_facts: yes

  # give root persmissions
  become: yes

  tasks:
    - name: Upgrade and update
      apt:
        upgrade: "yes"
        update_cache: yes
        cache_valid_time: 3600

    - name: Install Python3
      apt:
        pkg:
          - python3
          - python3-pip

    - name: Set Python3 as default Python
      shell: |
        sudo update-alternatives --install /usr/bin/python python /usr/bin/python2.7 20
        sudo update-alternatives --install /usr/bin/python python /usr/bin/python3.6 10


    - name: show the app_dir variable
      debug:
        msg: "{{ app_dir }}"

    - name: Install Python requirements from the file provided
      pip:
        requirements: /home/ubuntu/it_jobswatch_devops_project/requirements.txt

